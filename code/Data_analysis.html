

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Logistic Regression &#8212; Predicting psychotic disorder with machine learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'code/Data_analysis';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Support Vector Machine (SVM)" href="SVM.html" />
    <link rel="prev" title="Data analysis" href="../general_information/Tasktype.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/brain.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/brain.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../general_information/TheoreticalBackground.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general_information/DataProjectManagement.html">Data- and Projectmanagement</a></li>
<li class="toctree-l1"><a class="reference internal" href="Data_exploration.html">Data exploration</a></li>

<li class="toctree-l1 current active has-children"><a class="reference internal" href="../general_information/Tasktype.html">Data analysis</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Logistic Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="SVM.html">Support Vector Machine (SVM)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../general_information/Discussion.html">Discussion</a></li>

<li class="toctree-l1 has-children"><a class="reference internal" href="../general_information/open_labnotebook.html">Openlab notebook</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../open_lab_notebook/November.html">November, 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../open_lab_notebook/December.html">December, 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../open_lab_notebook/January.html">January, 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../open_lab_notebook/February.html">February, 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../open_lab_notebook/March.html">March, 2023</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../general_information/References.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/mello-y/MSc5_research_project/master?urlpath=tree/content/code/Data_analysis.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/mello-y/MSc5_research_project" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mello-y/MSc5_research_project/edit/master/content/code/Data_analysis.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mello-y/MSc5_research_project/issues/new?title=Issue%20on%20page%20%2Fcode/Data_analysis.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/code/Data_analysis.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Logistic Regression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#macro-structural-data-cortical-thickness-ct">1. Macro-structural data: Cortical Thickness (CT)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preperation">1.1 Data preperation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-the-model">1.2 Building the model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-evaluation">1.3 Model evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#confusion-matrix">1.3.1 Confusion Matrix</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#model-accuracy-precision-recall-f1-score">1.3.2 Model accuracy, precision, recall F1-Score</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#micro-structural-data-mean-diffusivity-md-and-fractional-anisotropy-fa">2. Micro-structural data: mean diffusivity (MD) and fractional anisotropy (FA)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-diffusivity">2.1 Mean diffusivity</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">2.1.1 Data preparation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#build-the-model">2.1.2 Build the model</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.1.3 Model evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2.1.3.1 Confusion matrix</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#model-accuracy-precision-recall-and-f1-score">2.1.3.2  Model accuracy, precision, recall and F1-Score</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fractional-anisotropy">2.2 Fractional anisotropy</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.2.1 Data preparation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">2.2.2 Build the model</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">2.2.3 Model evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">2.2.3.1 Confusion matrix</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">2.2.3.2 Model accuracy, precision, recall and F1-Score</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">3. Summary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="logistic-regression">
<h1>Logistic Regression<a class="headerlink" href="#logistic-regression" title="Permalink to this heading">#</a></h1>
<p>In this chapter the logistic regression algorithm is applied to the macro- and microstrucutral data. The procedure is analogous to both kind of data. First, the data is prepared in terms of making it suitable to use it in the code efficiently. Second, the logistic regression model is built, defining the input and output variables, scaling the relevant variables and splitting the data set into training and testing samples and subsequently training the model. Followed by evulating the model, we will refer to different metrics that provide information on how the model performs.</p>
<p>We first start with <strong>cortical thickness (CT)</strong>.</p>
<section id="macro-structural-data-cortical-thickness-ct">
<h2>1. Macro-structural data: Cortical Thickness (CT)<a class="headerlink" href="#macro-structural-data-cortical-thickness-ct" title="Permalink to this heading">#</a></h2>
<section id="data-preperation">
<h3>1.1 Data preperation<a class="headerlink" href="#data-preperation" title="Permalink to this heading">#</a></h3>
<p>In the beginning, all relevant modules needed for the analysis are imported.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#import relevant modules</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline


<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span> 
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
</pre></div>
</div>
</div>
</div>
<p>Again, to read the data, the os.pardir() function is used to make the code reproducible independent of different operating systems.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#read data</span>

<span class="n">CT_Dublin_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pardir</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;PARC_500.aparc_thickness_Dublin.csv&#39;</span><span class="p">)</span>
<span class="n">CT_Dublin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">CT_Dublin_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CT_Dublin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Subject ID</th>
      <th>Age</th>
      <th>Sex</th>
      <th>Group</th>
      <th>lh_bankssts_part1_thickness</th>
      <th>lh_bankssts_part2_thickness</th>
      <th>lh_caudalanteriorcingulate_part1_thickness</th>
      <th>lh_caudalmiddlefrontal_part1_thickness</th>
      <th>lh_caudalmiddlefrontal_part2_thickness</th>
      <th>lh_caudalmiddlefrontal_part3_thickness</th>
      <th>...</th>
      <th>rh_supramarginal_part5_thickness</th>
      <th>rh_supramarginal_part6_thickness</th>
      <th>rh_supramarginal_part7_thickness</th>
      <th>rh_frontalpole_part1_thickness</th>
      <th>rh_temporalpole_part1_thickness</th>
      <th>rh_transversetemporal_part1_thickness</th>
      <th>rh_insula_part1_thickness</th>
      <th>rh_insula_part2_thickness</th>
      <th>rh_insula_part3_thickness</th>
      <th>rh_insula_part4_thickness</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CON9225</td>
      <td>21</td>
      <td>2</td>
      <td>1</td>
      <td>2.180</td>
      <td>2.382</td>
      <td>2.346</td>
      <td>2.526</td>
      <td>2.747</td>
      <td>2.544</td>
      <td>...</td>
      <td>2.817</td>
      <td>2.325</td>
      <td>2.430</td>
      <td>3.004</td>
      <td>3.979</td>
      <td>2.329</td>
      <td>3.620</td>
      <td>2.776</td>
      <td>3.282</td>
      <td>3.347</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CON9229</td>
      <td>28</td>
      <td>2</td>
      <td>1</td>
      <td>2.394</td>
      <td>1.973</td>
      <td>2.534</td>
      <td>2.439</td>
      <td>2.485</td>
      <td>2.435</td>
      <td>...</td>
      <td>2.611</td>
      <td>2.418</td>
      <td>2.317</td>
      <td>2.794</td>
      <td>3.851</td>
      <td>2.034</td>
      <td>3.588</td>
      <td>2.654</td>
      <td>3.124</td>
      <td>3.214</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CON9231</td>
      <td>29</td>
      <td>2</td>
      <td>1</td>
      <td>2.551</td>
      <td>2.567</td>
      <td>1.954</td>
      <td>2.439</td>
      <td>2.428</td>
      <td>2.190</td>
      <td>...</td>
      <td>2.777</td>
      <td>2.309</td>
      <td>2.390</td>
      <td>2.365</td>
      <td>4.039</td>
      <td>2.337</td>
      <td>3.657</td>
      <td>2.495</td>
      <td>2.669</td>
      <td>2.886</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GASP3037</td>
      <td>61</td>
      <td>1</td>
      <td>2</td>
      <td>2.187</td>
      <td>1.923</td>
      <td>2.160</td>
      <td>2.410</td>
      <td>2.381</td>
      <td>2.277</td>
      <td>...</td>
      <td>2.265</td>
      <td>2.306</td>
      <td>2.129</td>
      <td>2.281</td>
      <td>3.505</td>
      <td>2.275</td>
      <td>3.121</td>
      <td>2.333</td>
      <td>2.604</td>
      <td>2.731</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GASP3040</td>
      <td>47</td>
      <td>1</td>
      <td>2</td>
      <td>1.862</td>
      <td>1.750</td>
      <td>2.129</td>
      <td>2.516</td>
      <td>2.244</td>
      <td>2.169</td>
      <td>...</td>
      <td>2.582</td>
      <td>2.314</td>
      <td>2.047</td>
      <td>2.389</td>
      <td>3.272</td>
      <td>2.445</td>
      <td>3.171</td>
      <td>2.216</td>
      <td>2.659</td>
      <td>2.657</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>103</th>
      <td>RPG9019</td>
      <td>31</td>
      <td>1</td>
      <td>2</td>
      <td>2.240</td>
      <td>2.150</td>
      <td>1.995</td>
      <td>2.254</td>
      <td>2.164</td>
      <td>2.008</td>
      <td>...</td>
      <td>2.273</td>
      <td>2.288</td>
      <td>2.395</td>
      <td>2.105</td>
      <td>3.267</td>
      <td>2.257</td>
      <td>3.231</td>
      <td>2.574</td>
      <td>2.920</td>
      <td>2.899</td>
    </tr>
    <tr>
      <th>104</th>
      <td>RPG9102</td>
      <td>42</td>
      <td>2</td>
      <td>2</td>
      <td>2.269</td>
      <td>2.124</td>
      <td>2.531</td>
      <td>2.502</td>
      <td>2.250</td>
      <td>2.183</td>
      <td>...</td>
      <td>2.302</td>
      <td>2.182</td>
      <td>2.182</td>
      <td>2.327</td>
      <td>2.881</td>
      <td>2.124</td>
      <td>3.159</td>
      <td>2.450</td>
      <td>2.753</td>
      <td>2.791</td>
    </tr>
    <tr>
      <th>105</th>
      <td>RPG9119</td>
      <td>41</td>
      <td>1</td>
      <td>2</td>
      <td>2.273</td>
      <td>2.559</td>
      <td>2.578</td>
      <td>2.463</td>
      <td>2.463</td>
      <td>2.053</td>
      <td>...</td>
      <td>2.534</td>
      <td>2.604</td>
      <td>2.449</td>
      <td>2.370</td>
      <td>3.111</td>
      <td>2.190</td>
      <td>3.480</td>
      <td>2.294</td>
      <td>2.571</td>
      <td>2.875</td>
    </tr>
    <tr>
      <th>106</th>
      <td>RPG9121</td>
      <td>51</td>
      <td>1</td>
      <td>2</td>
      <td>1.940</td>
      <td>2.438</td>
      <td>2.272</td>
      <td>2.272</td>
      <td>2.610</td>
      <td>2.099</td>
      <td>...</td>
      <td>2.638</td>
      <td>2.225</td>
      <td>2.013</td>
      <td>2.115</td>
      <td>3.853</td>
      <td>2.231</td>
      <td>3.187</td>
      <td>2.510</td>
      <td>2.759</td>
      <td>2.838</td>
    </tr>
    <tr>
      <th>107</th>
      <td>RPG9126</td>
      <td>56</td>
      <td>1</td>
      <td>2</td>
      <td>2.108</td>
      <td>2.269</td>
      <td>2.145</td>
      <td>2.192</td>
      <td>2.443</td>
      <td>1.977</td>
      <td>...</td>
      <td>2.013</td>
      <td>2.251</td>
      <td>2.021</td>
      <td>2.419</td>
      <td>3.679</td>
      <td>1.970</td>
      <td>3.192</td>
      <td>2.551</td>
      <td>2.855</td>
      <td>2.985</td>
    </tr>
  </tbody>
</table>
<p>108 rows × 312 columns</p>
</div></div></div>
</div>
<p>The data contains variables such as SubjectID, Age and Sex which are not relevant for the classification. Hence, we adjust the dataframe accordingly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#adjust dataframe</span>

<span class="n">CT_Dublin_adj</span> <span class="o">=</span> <span class="n">CT_Dublin</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Subject ID&#39;</span><span class="p">,</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CT_Dublin_adj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>lh_bankssts_part1_thickness</th>
      <th>lh_bankssts_part2_thickness</th>
      <th>lh_caudalanteriorcingulate_part1_thickness</th>
      <th>lh_caudalmiddlefrontal_part1_thickness</th>
      <th>lh_caudalmiddlefrontal_part2_thickness</th>
      <th>lh_caudalmiddlefrontal_part3_thickness</th>
      <th>lh_caudalmiddlefrontal_part4_thickness</th>
      <th>lh_cuneus_part1_thickness</th>
      <th>lh_cuneus_part2_thickness</th>
      <th>...</th>
      <th>rh_supramarginal_part5_thickness</th>
      <th>rh_supramarginal_part6_thickness</th>
      <th>rh_supramarginal_part7_thickness</th>
      <th>rh_frontalpole_part1_thickness</th>
      <th>rh_temporalpole_part1_thickness</th>
      <th>rh_transversetemporal_part1_thickness</th>
      <th>rh_insula_part1_thickness</th>
      <th>rh_insula_part2_thickness</th>
      <th>rh_insula_part3_thickness</th>
      <th>rh_insula_part4_thickness</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2.180</td>
      <td>2.382</td>
      <td>2.346</td>
      <td>2.526</td>
      <td>2.747</td>
      <td>2.544</td>
      <td>2.582</td>
      <td>1.816</td>
      <td>2.228</td>
      <td>...</td>
      <td>2.817</td>
      <td>2.325</td>
      <td>2.430</td>
      <td>3.004</td>
      <td>3.979</td>
      <td>2.329</td>
      <td>3.620</td>
      <td>2.776</td>
      <td>3.282</td>
      <td>3.347</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2.394</td>
      <td>1.973</td>
      <td>2.534</td>
      <td>2.439</td>
      <td>2.485</td>
      <td>2.435</td>
      <td>2.458</td>
      <td>1.723</td>
      <td>1.821</td>
      <td>...</td>
      <td>2.611</td>
      <td>2.418</td>
      <td>2.317</td>
      <td>2.794</td>
      <td>3.851</td>
      <td>2.034</td>
      <td>3.588</td>
      <td>2.654</td>
      <td>3.124</td>
      <td>3.214</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>2.551</td>
      <td>2.567</td>
      <td>1.954</td>
      <td>2.439</td>
      <td>2.428</td>
      <td>2.190</td>
      <td>2.377</td>
      <td>2.026</td>
      <td>1.800</td>
      <td>...</td>
      <td>2.777</td>
      <td>2.309</td>
      <td>2.390</td>
      <td>2.365</td>
      <td>4.039</td>
      <td>2.337</td>
      <td>3.657</td>
      <td>2.495</td>
      <td>2.669</td>
      <td>2.886</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>2.187</td>
      <td>1.923</td>
      <td>2.160</td>
      <td>2.410</td>
      <td>2.381</td>
      <td>2.277</td>
      <td>2.361</td>
      <td>1.585</td>
      <td>1.750</td>
      <td>...</td>
      <td>2.265</td>
      <td>2.306</td>
      <td>2.129</td>
      <td>2.281</td>
      <td>3.505</td>
      <td>2.275</td>
      <td>3.121</td>
      <td>2.333</td>
      <td>2.604</td>
      <td>2.731</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>1.862</td>
      <td>1.750</td>
      <td>2.129</td>
      <td>2.516</td>
      <td>2.244</td>
      <td>2.169</td>
      <td>2.220</td>
      <td>1.646</td>
      <td>1.717</td>
      <td>...</td>
      <td>2.582</td>
      <td>2.314</td>
      <td>2.047</td>
      <td>2.389</td>
      <td>3.272</td>
      <td>2.445</td>
      <td>3.171</td>
      <td>2.216</td>
      <td>2.659</td>
      <td>2.657</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>103</th>
      <td>2</td>
      <td>2.240</td>
      <td>2.150</td>
      <td>1.995</td>
      <td>2.254</td>
      <td>2.164</td>
      <td>2.008</td>
      <td>2.298</td>
      <td>1.918</td>
      <td>1.717</td>
      <td>...</td>
      <td>2.273</td>
      <td>2.288</td>
      <td>2.395</td>
      <td>2.105</td>
      <td>3.267</td>
      <td>2.257</td>
      <td>3.231</td>
      <td>2.574</td>
      <td>2.920</td>
      <td>2.899</td>
    </tr>
    <tr>
      <th>104</th>
      <td>2</td>
      <td>2.269</td>
      <td>2.124</td>
      <td>2.531</td>
      <td>2.502</td>
      <td>2.250</td>
      <td>2.183</td>
      <td>2.408</td>
      <td>1.539</td>
      <td>1.611</td>
      <td>...</td>
      <td>2.302</td>
      <td>2.182</td>
      <td>2.182</td>
      <td>2.327</td>
      <td>2.881</td>
      <td>2.124</td>
      <td>3.159</td>
      <td>2.450</td>
      <td>2.753</td>
      <td>2.791</td>
    </tr>
    <tr>
      <th>105</th>
      <td>2</td>
      <td>2.273</td>
      <td>2.559</td>
      <td>2.578</td>
      <td>2.463</td>
      <td>2.463</td>
      <td>2.053</td>
      <td>2.526</td>
      <td>1.733</td>
      <td>1.859</td>
      <td>...</td>
      <td>2.534</td>
      <td>2.604</td>
      <td>2.449</td>
      <td>2.370</td>
      <td>3.111</td>
      <td>2.190</td>
      <td>3.480</td>
      <td>2.294</td>
      <td>2.571</td>
      <td>2.875</td>
    </tr>
    <tr>
      <th>106</th>
      <td>2</td>
      <td>1.940</td>
      <td>2.438</td>
      <td>2.272</td>
      <td>2.272</td>
      <td>2.610</td>
      <td>2.099</td>
      <td>2.538</td>
      <td>1.931</td>
      <td>1.792</td>
      <td>...</td>
      <td>2.638</td>
      <td>2.225</td>
      <td>2.013</td>
      <td>2.115</td>
      <td>3.853</td>
      <td>2.231</td>
      <td>3.187</td>
      <td>2.510</td>
      <td>2.759</td>
      <td>2.838</td>
    </tr>
    <tr>
      <th>107</th>
      <td>2</td>
      <td>2.108</td>
      <td>2.269</td>
      <td>2.145</td>
      <td>2.192</td>
      <td>2.443</td>
      <td>1.977</td>
      <td>2.453</td>
      <td>1.590</td>
      <td>1.715</td>
      <td>...</td>
      <td>2.013</td>
      <td>2.251</td>
      <td>2.021</td>
      <td>2.419</td>
      <td>3.679</td>
      <td>1.970</td>
      <td>3.192</td>
      <td>2.551</td>
      <td>2.855</td>
      <td>2.985</td>
    </tr>
  </tbody>
</table>
<p>108 rows × 309 columns</p>
</div></div></div>
</div>
<p>As the dataframe shows, the Group variable contains information of whether the samples belong to control or patient. In this case, 1 indicates control and 2 patient. In order to perform a <strong>Logistic Regression</strong>, the labels of the outputs require to be 0 and 1 since the probability of an instance belonging to a default class is computed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#label group 1 as 0 and 2 as 1</span>

<span class="n">CT_Dublin_adj</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CT_Dublin_adj</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CT_Dublin_adj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>lh_bankssts_part1_thickness</th>
      <th>lh_bankssts_part2_thickness</th>
      <th>lh_caudalanteriorcingulate_part1_thickness</th>
      <th>lh_caudalmiddlefrontal_part1_thickness</th>
      <th>lh_caudalmiddlefrontal_part2_thickness</th>
      <th>lh_caudalmiddlefrontal_part3_thickness</th>
      <th>lh_caudalmiddlefrontal_part4_thickness</th>
      <th>lh_cuneus_part1_thickness</th>
      <th>lh_cuneus_part2_thickness</th>
      <th>...</th>
      <th>rh_supramarginal_part5_thickness</th>
      <th>rh_supramarginal_part6_thickness</th>
      <th>rh_supramarginal_part7_thickness</th>
      <th>rh_frontalpole_part1_thickness</th>
      <th>rh_temporalpole_part1_thickness</th>
      <th>rh_transversetemporal_part1_thickness</th>
      <th>rh_insula_part1_thickness</th>
      <th>rh_insula_part2_thickness</th>
      <th>rh_insula_part3_thickness</th>
      <th>rh_insula_part4_thickness</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2.180</td>
      <td>2.382</td>
      <td>2.346</td>
      <td>2.526</td>
      <td>2.747</td>
      <td>2.544</td>
      <td>2.582</td>
      <td>1.816</td>
      <td>2.228</td>
      <td>...</td>
      <td>2.817</td>
      <td>2.325</td>
      <td>2.430</td>
      <td>3.004</td>
      <td>3.979</td>
      <td>2.329</td>
      <td>3.620</td>
      <td>2.776</td>
      <td>3.282</td>
      <td>3.347</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>2.394</td>
      <td>1.973</td>
      <td>2.534</td>
      <td>2.439</td>
      <td>2.485</td>
      <td>2.435</td>
      <td>2.458</td>
      <td>1.723</td>
      <td>1.821</td>
      <td>...</td>
      <td>2.611</td>
      <td>2.418</td>
      <td>2.317</td>
      <td>2.794</td>
      <td>3.851</td>
      <td>2.034</td>
      <td>3.588</td>
      <td>2.654</td>
      <td>3.124</td>
      <td>3.214</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>2.551</td>
      <td>2.567</td>
      <td>1.954</td>
      <td>2.439</td>
      <td>2.428</td>
      <td>2.190</td>
      <td>2.377</td>
      <td>2.026</td>
      <td>1.800</td>
      <td>...</td>
      <td>2.777</td>
      <td>2.309</td>
      <td>2.390</td>
      <td>2.365</td>
      <td>4.039</td>
      <td>2.337</td>
      <td>3.657</td>
      <td>2.495</td>
      <td>2.669</td>
      <td>2.886</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>2.187</td>
      <td>1.923</td>
      <td>2.160</td>
      <td>2.410</td>
      <td>2.381</td>
      <td>2.277</td>
      <td>2.361</td>
      <td>1.585</td>
      <td>1.750</td>
      <td>...</td>
      <td>2.265</td>
      <td>2.306</td>
      <td>2.129</td>
      <td>2.281</td>
      <td>3.505</td>
      <td>2.275</td>
      <td>3.121</td>
      <td>2.333</td>
      <td>2.604</td>
      <td>2.731</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1.862</td>
      <td>1.750</td>
      <td>2.129</td>
      <td>2.516</td>
      <td>2.244</td>
      <td>2.169</td>
      <td>2.220</td>
      <td>1.646</td>
      <td>1.717</td>
      <td>...</td>
      <td>2.582</td>
      <td>2.314</td>
      <td>2.047</td>
      <td>2.389</td>
      <td>3.272</td>
      <td>2.445</td>
      <td>3.171</td>
      <td>2.216</td>
      <td>2.659</td>
      <td>2.657</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>103</th>
      <td>1</td>
      <td>2.240</td>
      <td>2.150</td>
      <td>1.995</td>
      <td>2.254</td>
      <td>2.164</td>
      <td>2.008</td>
      <td>2.298</td>
      <td>1.918</td>
      <td>1.717</td>
      <td>...</td>
      <td>2.273</td>
      <td>2.288</td>
      <td>2.395</td>
      <td>2.105</td>
      <td>3.267</td>
      <td>2.257</td>
      <td>3.231</td>
      <td>2.574</td>
      <td>2.920</td>
      <td>2.899</td>
    </tr>
    <tr>
      <th>104</th>
      <td>1</td>
      <td>2.269</td>
      <td>2.124</td>
      <td>2.531</td>
      <td>2.502</td>
      <td>2.250</td>
      <td>2.183</td>
      <td>2.408</td>
      <td>1.539</td>
      <td>1.611</td>
      <td>...</td>
      <td>2.302</td>
      <td>2.182</td>
      <td>2.182</td>
      <td>2.327</td>
      <td>2.881</td>
      <td>2.124</td>
      <td>3.159</td>
      <td>2.450</td>
      <td>2.753</td>
      <td>2.791</td>
    </tr>
    <tr>
      <th>105</th>
      <td>1</td>
      <td>2.273</td>
      <td>2.559</td>
      <td>2.578</td>
      <td>2.463</td>
      <td>2.463</td>
      <td>2.053</td>
      <td>2.526</td>
      <td>1.733</td>
      <td>1.859</td>
      <td>...</td>
      <td>2.534</td>
      <td>2.604</td>
      <td>2.449</td>
      <td>2.370</td>
      <td>3.111</td>
      <td>2.190</td>
      <td>3.480</td>
      <td>2.294</td>
      <td>2.571</td>
      <td>2.875</td>
    </tr>
    <tr>
      <th>106</th>
      <td>1</td>
      <td>1.940</td>
      <td>2.438</td>
      <td>2.272</td>
      <td>2.272</td>
      <td>2.610</td>
      <td>2.099</td>
      <td>2.538</td>
      <td>1.931</td>
      <td>1.792</td>
      <td>...</td>
      <td>2.638</td>
      <td>2.225</td>
      <td>2.013</td>
      <td>2.115</td>
      <td>3.853</td>
      <td>2.231</td>
      <td>3.187</td>
      <td>2.510</td>
      <td>2.759</td>
      <td>2.838</td>
    </tr>
    <tr>
      <th>107</th>
      <td>1</td>
      <td>2.108</td>
      <td>2.269</td>
      <td>2.145</td>
      <td>2.192</td>
      <td>2.443</td>
      <td>1.977</td>
      <td>2.453</td>
      <td>1.590</td>
      <td>1.715</td>
      <td>...</td>
      <td>2.013</td>
      <td>2.251</td>
      <td>2.021</td>
      <td>2.419</td>
      <td>3.679</td>
      <td>1.970</td>
      <td>3.192</td>
      <td>2.551</td>
      <td>2.855</td>
      <td>2.985</td>
    </tr>
  </tbody>
</table>
<p>108 rows × 309 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get shape of df_adj</span>

<span class="n">CT_Dublin_adj</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(108, 309)
</pre></div>
</div>
</div>
</div>
<p>Because the LogisticRegression function from sklearn requires the inputs to be numpy arrays, in the following step the dataframe is converted to a numpy array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dataframe as numpy array </span>

<span class="n">CT_Dublin_adj</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.   , 2.18 , 2.382, ..., 2.776, 3.282, 3.347],
       [0.   , 2.394, 1.973, ..., 2.654, 3.124, 3.214],
       [0.   , 2.551, 2.567, ..., 2.495, 2.669, 2.886],
       ...,
       [1.   , 2.273, 2.559, ..., 2.294, 2.571, 2.875],
       [1.   , 1.94 , 2.438, ..., 2.51 , 2.759, 2.838],
       [1.   , 2.108, 2.269, ..., 2.551, 2.855, 2.985]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="building-the-model">
<h3>1.2 Building the model<a class="headerlink" href="#building-the-model" title="Permalink to this heading">#</a></h3>
<p>In the next steps, the <strong>logistic regression</strong> model is built. Firstly, the input and output should be defined. Our input contains the <strong>CT</strong> for all of the 308 brain regions, meaning that there are n=308 features in total. The output is within the Group variable containing label information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define input</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">CT_Dublin_adj</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">309</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[2.18 , 2.382, 2.346, ..., 2.776, 3.282, 3.347],
       [2.394, 1.973, 2.534, ..., 2.654, 3.124, 3.214],
       [2.551, 2.567, 1.954, ..., 2.495, 2.669, 2.886],
       ...,
       [2.273, 2.559, 2.578, ..., 2.294, 2.571, 2.875],
       [1.94 , 2.438, 2.272, ..., 2.51 , 2.759, 2.838],
       [2.108, 2.269, 2.145, ..., 2.551, 2.855, 2.985]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(108, 308)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#output</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">CT_Dublin_adj</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0],
       [0],
       [0],
       [1],
       [1],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1],
       [1]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(108, 1)
</pre></div>
</div>
</div>
</div>
<p>The numpy.ravel() functions returns contiguous flattened array (1D array with all the input-array elements and with the same type as it). This step is required for the upcoming analyses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(108,)
</pre></div>
</div>
</div>
</div>
<p>Now having defined our input and ouput data, to build the logistic regression model we need to split our data into train and test sets. For this, we use the train_test_split splitter function from Sklearn. The training set is the dataset on which the model is trained. This data is seen and learned by the model. The test set is a a subset of the training set and utilized for an accurate evaluation of a final model fit.
With that function, the data gets divided into X_train, X_test, y_train and y_test. X_train and y_train are used for training and fitting the model. The X_test and y_test sets, however, are used for training the model if the correct labels were predicted.</p>
<p>But before splitting the data into training and testing set, we use the StandardScaler() function to standardize our data. The function standardizes every feature (each column) indivudally by substracting the mean and then scaling to unit variance (dividing all the values by the standard deviation). As a result, we get a distribution with a mean equal to 0 and with a standard deviation equal to 1.</p>
<p>Also, with such a small sample, the N=27 participants (108 * 25%) in the testing sample could differ considerably from the training sample by chance. To tackle this problem, we can run the cross validation for 5000 iterations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_iter</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">y_preds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">y_tests</span> <span class="o">=</span> <span class="p">[]</span>


<span class="c1"># scale before splitting into test and train samples</span>
<span class="n">X_sc</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iter</span><span class="p">):</span>
    
    <span class="c1"># take a new testing and training sample</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_sc</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">y_tests</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>  <span class="c1"># store the y_test sample</span>
 
    <span class="c1"># fit the logistic regression</span>
    <span class="n">classifier</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">solver</span> <span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">)</span>
    <span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># get the y predictions and store</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">y_preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The test size indicates the size of the test subset, a random sampling without replacement about 75% of the rows , the remaining 25% is put into the test set. The random_state parameter allows you to reproduce the same train test split each time when the code is run. With a different value for random_state, different information would flow into the train and test sets.</p>
<p>The following outputs show the first five lines of the iterations for our predicted y values and y testing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_preds</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[array([1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1,
        1, 1, 0, 1, 0]),
 array([1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1,
        0, 1, 0, 1, 0]),
 array([1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1,
        1, 1, 0, 1, 1]),
 array([1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1,
        1, 1, 0, 0, 1]),
 array([1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0,
        1, 0, 0, 0, 1])]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_tests</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[array([1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0,
        0, 1, 0, 1, 0]),
 array([1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1,
        0, 1, 0, 0, 0]),
 array([0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1,
        0, 1, 0, 1, 0]),
 array([1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0,
        1, 0, 0, 0, 0]),
 array([0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
        1, 0, 0, 0, 1])]
</pre></div>
</div>
</div>
</div>
<p>In the following, we can concatenate the the y_pred and y_test results from each iteration and use this to compute the confusion matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_preds</span><span class="p">])</span>
<span class="n">y_preds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 0, 1, ..., 1, 1, 1])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_tests</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_tests</span><span class="p">])</span>
<span class="n">y_tests</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 0, 0, ..., 1, 0, 1])
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-evaluation">
<h3>1.3 Model evaluation<a class="headerlink" href="#model-evaluation" title="Permalink to this heading">#</a></h3>
<p>In the next section, we will have a look at how the logistic regression model performs and evaluate it. To evaluate the model, a look at different measurements such as the <strong>confusion matrix</strong>, <strong>accuracy, precision and recall</strong> is helpful.</p>
<section id="confusion-matrix">
<h4>1.3.1 Confusion Matrix<a class="headerlink" href="#confusion-matrix" title="Permalink to this heading">#</a></h4>
<p>The <strong>confusion matrix</strong> provides information on the quality of the logistic regression model since it shows the predicted values from the model compared to the actual values from the test dataset. We scale this by the sum of the array to get probabilities for <strong>hits, misses, false positives and true negatives</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm_CT</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_tests</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">)</span>

<span class="n">cm_CT_f</span> <span class="o">=</span> <span class="n">cm_CT</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cm_CT</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix : </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cm_CT_f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confusion Matrix : 
 [[0.43165926 0.31014074]
 [0.00807407 0.25012593]]
</pre></div>
</div>
</div>
</div>
<p>To make the confusion matrix visually more appealing and more informative, we run the following code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> 
<span class="n">tick_marks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">class_names</span><span class="p">))</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="n">class_names</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="n">class_names</span><span class="p">)</span> 
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cm_CT_f</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;YlGnBu&quot;</span> <span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix for Cortical Thickness&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual label&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted label&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 257.44, &#39;Predicted label&#39;)
</pre></div>
</div>
<img alt="../_images/8bca50afe2545cbafc83aae84891fae3c8fa1d3199449b3c32f9897629a7114d.png" src="../_images/8bca50afe2545cbafc83aae84891fae3c8fa1d3199449b3c32f9897629a7114d.png" />
</div>
</div>
<p>The confusion matrix can be interpreted as follows:</p>
<ul class="simple">
<li><p>Bottom righ square: <strong>True positives</strong> or <strong>hits</strong> -&gt; predicted a subject to be patient and he is</p></li>
<li><p>Upper left square: <strong>True negatives</strong> -&gt; predicted a subject to be control and he is</p></li>
<li><p>Upper right square: <strong>False positive (Type 1 Error)</strong> -&gt; predicted a subject as patient but he is control</p></li>
<li><p>Bottom left square: <strong>False negative (Type 2 Error)</strong> or <strong>misses</strong> -&gt; predicted a subject as control but he is patient</p></li>
</ul>
<p>The results show that the probability for <strong>hits</strong> is around 25%, for <strong>true negatives</strong> around 43%. The probability for <strong>misses</strong> is around 0.8%. The probability for <strong>false positive</strong> cases is around 31%.
As we can see, the model is better at classifying controls than patients.
However, based on these values we can compute other measures such as <strong>accuracy, precision, recall and F1-Score</strong> indicating the qualtiy of the model.</p>
</section>
<section id="model-accuracy-precision-recall-f1-score">
<h4>1.3.2 Model accuracy, precision, recall F1-Score<a class="headerlink" href="#model-accuracy-precision-recall-f1-score" title="Permalink to this heading">#</a></h4>
<p>The measures indicate the following:</p>
<ul class="simple">
<li><p><strong>Accuracy</strong>: percentage of correct predictions</p></li>
<li><p><strong>Precision</strong>: correct positive predictions relative to total positive predictions. In other words: From all the cases predicted as positive, how many are actually positive.</p></li>
<li><p><strong>Recall</strong>: the correct positive predictions relative to total actual positives. In other words: From all the positive cases, how many were predicted correctly.</p></li>
<li><p><strong>F1-Score</strong>: combines the precision and recall of a classifier into a single metric by taking their harmonic mean. It is primarily used to compare the performance of two classifiers.</p></li>
</ul>
<p>To compute these measures, we can simply use <code class="docutils literal notranslate"><span class="pre">sklearn.metrics</span> <span class="pre">module</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy:&quot;</span><span class="p">,</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_tests</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">))</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Precision:&quot;</span><span class="p">,</span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_tests</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">))</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Recall:&quot;</span><span class="p">,</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_tests</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">))</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;F1-Score:&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_tests</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.6817851851851852
Precision: 0.446440848273309
Recall: 0.9687293800384428
F1-Score: 0.6112061397554596
</pre></div>
</div>
</div>
</div>
<p>So as the values show, our logistic regression model for <strong>cortical thickness</strong> makes 68.18% of the time correct predictions. 44.64% represent the proportion of the model’s prediction of psychosis where psychosis is actually present and 96.87% relate to the proportion of all cases of psychosis that the model accurately predicted.</p>
</section>
</section>
</section>
<section id="micro-structural-data-mean-diffusivity-md-and-fractional-anisotropy-fa">
<h2>2. Micro-structural data: mean diffusivity (MD) and fractional anisotropy (FA)<a class="headerlink" href="#micro-structural-data-mean-diffusivity-md-and-fractional-anisotropy-fa" title="Permalink to this heading">#</a></h2>
<p>In the following section, the logistic regression model is computed for <strong>micro-structural</strong> data in an analogous way as for the macro-structural data. We first start with <strong>MD</strong>.</p>
<section id="mean-diffusivity">
<h3>2.1 Mean diffusivity<a class="headerlink" href="#mean-diffusivity" title="Permalink to this heading">#</a></h3>
<p>First, we prepare our data to use it in the code efficiently and adjust it for the logistic regression accordingly.</p>
<section id="data-preparation">
<h4>2.1.1 Data preparation<a class="headerlink" href="#data-preparation" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#read data</span>

<span class="n">MD_Dublin_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pardir</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;PARC_500.aparc_MD_cortexAv_mean_Dublin.csv&#39;</span><span class="p">)</span>
<span class="n">MD_Dublin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">MD_Dublin_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#adjust dataframe</span>

<span class="n">MD_Dublin_adj</span> <span class="o">=</span> <span class="n">MD_Dublin</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Subject ID&#39;</span><span class="p">,</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#label group 1 as 0 and 2 as 1</span>

<span class="n">MD_Dublin_adj</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MD_Dublin_adj</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MD_Dublin_adj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>lh_bankssts_part1_thickness</th>
      <th>lh_bankssts_part2_thickness</th>
      <th>lh_caudalanteriorcingulate_part1_thickness</th>
      <th>lh_caudalmiddlefrontal_part1_thickness</th>
      <th>lh_caudalmiddlefrontal_part2_thickness</th>
      <th>lh_caudalmiddlefrontal_part3_thickness</th>
      <th>lh_caudalmiddlefrontal_part4_thickness</th>
      <th>lh_cuneus_part1_thickness</th>
      <th>lh_cuneus_part2_thickness</th>
      <th>...</th>
      <th>rh_supramarginal_part5_thickness</th>
      <th>rh_supramarginal_part6_thickness</th>
      <th>rh_supramarginal_part7_thickness</th>
      <th>rh_frontalpole_part1_thickness</th>
      <th>rh_temporalpole_part1_thickness</th>
      <th>rh_transversetemporal_part1_thickness</th>
      <th>rh_insula_part1_thickness</th>
      <th>rh_insula_part2_thickness</th>
      <th>rh_insula_part3_thickness</th>
      <th>rh_insula_part4_thickness</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0.911</td>
      <td>0.931</td>
      <td>0.891</td>
      <td>1.048</td>
      <td>0.881</td>
      <td>0.939</td>
      <td>1.124</td>
      <td>0.986</td>
      <td>1.045</td>
      <td>...</td>
      <td>0.928</td>
      <td>1.067</td>
      <td>1.096</td>
      <td>0.892</td>
      <td>1.238</td>
      <td>1.021</td>
      <td>1.166</td>
      <td>0.900</td>
      <td>0.907</td>
      <td>0.937</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0.861</td>
      <td>0.913</td>
      <td>0.846</td>
      <td>0.927</td>
      <td>0.888</td>
      <td>0.894</td>
      <td>0.924</td>
      <td>1.040</td>
      <td>1.093</td>
      <td>...</td>
      <td>0.878</td>
      <td>0.985</td>
      <td>1.045</td>
      <td>1.001</td>
      <td>1.196</td>
      <td>1.083</td>
      <td>1.143</td>
      <td>0.917</td>
      <td>0.923</td>
      <td>0.960</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0.817</td>
      <td>0.827</td>
      <td>0.828</td>
      <td>0.828</td>
      <td>0.780</td>
      <td>0.843</td>
      <td>0.825</td>
      <td>0.848</td>
      <td>0.838</td>
      <td>...</td>
      <td>0.847</td>
      <td>0.849</td>
      <td>0.819</td>
      <td>0.952</td>
      <td>0.933</td>
      <td>0.942</td>
      <td>1.059</td>
      <td>0.794</td>
      <td>0.834</td>
      <td>0.860</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0.887</td>
      <td>0.905</td>
      <td>0.878</td>
      <td>0.932</td>
      <td>0.820</td>
      <td>0.888</td>
      <td>0.970</td>
      <td>0.918</td>
      <td>0.900</td>
      <td>...</td>
      <td>0.957</td>
      <td>0.985</td>
      <td>0.989</td>
      <td>1.075</td>
      <td>1.150</td>
      <td>1.017</td>
      <td>0.986</td>
      <td>0.888</td>
      <td>0.916</td>
      <td>0.928</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0.887</td>
      <td>0.854</td>
      <td>0.905</td>
      <td>1.011</td>
      <td>0.946</td>
      <td>0.922</td>
      <td>1.034</td>
      <td>1.126</td>
      <td>1.114</td>
      <td>...</td>
      <td>0.871</td>
      <td>0.952</td>
      <td>0.987</td>
      <td>1.325</td>
      <td>0.996</td>
      <td>1.094</td>
      <td>1.064</td>
      <td>0.966</td>
      <td>0.989</td>
      <td>0.977</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>110</th>
      <td>1</td>
      <td>0.843</td>
      <td>0.855</td>
      <td>0.940</td>
      <td>1.017</td>
      <td>0.954</td>
      <td>0.840</td>
      <td>1.128</td>
      <td>1.012</td>
      <td>0.997</td>
      <td>...</td>
      <td>0.938</td>
      <td>1.062</td>
      <td>1.143</td>
      <td>0.903</td>
      <td>1.364</td>
      <td>1.284</td>
      <td>1.218</td>
      <td>1.017</td>
      <td>0.972</td>
      <td>1.028</td>
    </tr>
    <tr>
      <th>111</th>
      <td>1</td>
      <td>0.911</td>
      <td>0.914</td>
      <td>0.926</td>
      <td>1.001</td>
      <td>0.918</td>
      <td>1.115</td>
      <td>1.036</td>
      <td>1.026</td>
      <td>1.001</td>
      <td>...</td>
      <td>0.957</td>
      <td>1.085</td>
      <td>1.098</td>
      <td>1.059</td>
      <td>1.268</td>
      <td>1.089</td>
      <td>1.173</td>
      <td>0.990</td>
      <td>1.065</td>
      <td>1.021</td>
    </tr>
    <tr>
      <th>112</th>
      <td>1</td>
      <td>0.890</td>
      <td>0.899</td>
      <td>0.886</td>
      <td>0.930</td>
      <td>0.883</td>
      <td>0.882</td>
      <td>0.883</td>
      <td>1.190</td>
      <td>1.101</td>
      <td>...</td>
      <td>0.916</td>
      <td>1.010</td>
      <td>0.974</td>
      <td>0.968</td>
      <td>1.305</td>
      <td>1.168</td>
      <td>1.265</td>
      <td>0.981</td>
      <td>0.975</td>
      <td>0.972</td>
    </tr>
    <tr>
      <th>113</th>
      <td>1</td>
      <td>0.920</td>
      <td>0.986</td>
      <td>0.883</td>
      <td>0.879</td>
      <td>0.794</td>
      <td>0.983</td>
      <td>1.029</td>
      <td>1.076</td>
      <td>1.053</td>
      <td>...</td>
      <td>0.942</td>
      <td>0.985</td>
      <td>0.990</td>
      <td>1.199</td>
      <td>1.353</td>
      <td>1.187</td>
      <td>1.444</td>
      <td>0.947</td>
      <td>1.047</td>
      <td>1.085</td>
    </tr>
    <tr>
      <th>114</th>
      <td>1</td>
      <td>0.970</td>
      <td>0.868</td>
      <td>0.940</td>
      <td>0.967</td>
      <td>0.930</td>
      <td>1.022</td>
      <td>0.957</td>
      <td>1.112</td>
      <td>1.004</td>
      <td>...</td>
      <td>1.074</td>
      <td>1.122</td>
      <td>1.215</td>
      <td>0.891</td>
      <td>1.333</td>
      <td>1.295</td>
      <td>1.284</td>
      <td>1.125</td>
      <td>1.110</td>
      <td>1.139</td>
    </tr>
  </tbody>
</table>
<p>115 rows × 309 columns</p>
</div></div></div>
</div>
<p>Very important is, not to forget to convert the dataframe into an numpy array!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dataframe as numpy array </span>

<span class="n">MD_Dublin_adj</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.   , 0.911, 0.931, ..., 0.9  , 0.907, 0.937],
       [0.   , 0.861, 0.913, ..., 0.917, 0.923, 0.96 ],
       [0.   , 0.817, 0.827, ..., 0.794, 0.834, 0.86 ],
       ...,
       [1.   , 0.89 , 0.899, ..., 0.981, 0.975, 0.972],
       [1.   , 0.92 , 0.986, ..., 0.947, 1.047, 1.085],
       [1.   , 0.97 , 0.868, ..., 1.125, 1.11 , 1.139]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="build-the-model">
<h4>2.1.2 Build the model<a class="headerlink" href="#build-the-model" title="Permalink to this heading">#</a></h4>
<p>In the next step, the input and output for our model is defined. For that, we use the <strong>MD</strong> for each 308 cortical region as input and the label whether a participant belongs to the control or patient group as output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define input</span>

<span class="n">X_MD</span> <span class="o">=</span> <span class="n">MD_Dublin_adj</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">309</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#output</span>

<span class="n">y_MD</span> <span class="o">=</span> <span class="n">MD_Dublin_adj</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_MD</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(115, 1)
</pre></div>
</div>
</div>
</div>
<p>To return a 1D flattened array since its required for further analyses, the .ravel() function is used!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_MD</span> <span class="o">=</span> <span class="n">y_MD</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_MD</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(115,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_MD</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.911, 0.931, 0.891, ..., 0.9  , 0.907, 0.937],
       [0.861, 0.913, 0.846, ..., 0.917, 0.923, 0.96 ],
       [0.817, 0.827, 0.828, ..., 0.794, 0.834, 0.86 ],
       ...,
       [0.89 , 0.899, 0.886, ..., 0.981, 0.975, 0.972],
       [0.92 , 0.986, 0.883, ..., 0.947, 1.047, 1.085],
       [0.97 , 0.868, 0.94 , ..., 1.125, 1.11 , 1.139]])
</pre></div>
</div>
</div>
</div>
<p>Again, we build our model with 5000 iterations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_iter_MD</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">y_preds_MD</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">y_tests_MD</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># scale before splitting into test and train samples</span>
<span class="n">X_sc_MD</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_MD</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iter</span><span class="p">):</span>
    <span class="c1"># take a new testing and training sample</span>
    <span class="n">X_train_MD</span><span class="p">,</span> <span class="n">X_test_MD</span><span class="p">,</span> <span class="n">y_train_MD</span><span class="p">,</span> <span class="n">y_test_MD</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_sc_MD</span><span class="p">,</span> <span class="n">y_MD</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">y_tests_MD</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_test_MD</span><span class="p">)</span>  <span class="c1"># store the y_test sample</span>
    
    <span class="c1"># fit the logistic regression</span>
    <span class="n">classifier_MD</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">solver</span> <span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">)</span>
    <span class="n">classifier_MD</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_MD</span><span class="p">,</span> <span class="n">y_train_MD</span><span class="p">)</span>
    
    <span class="c1"># get the y predictions and store</span>
    <span class="n">y_pred_MD</span> <span class="o">=</span> <span class="n">classifier_MD</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_MD</span><span class="p">)</span>
    <span class="n">y_preds_MD</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_pred_MD</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the following steps, we again concatenate the values to compute the confusion matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_preds_MD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_preds_MD</span><span class="p">])</span>
<span class="n">y_preds_MD</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 0, 0, ..., 1, 0, 1])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_tests_MD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_tests_MD</span><span class="p">])</span>
<span class="n">y_tests_MD</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 0, 0, ..., 0, 0, 1])
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h4>2.1.3 Model evaluation<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h4>
<p>Next, we will again have a look at the confusion matrix and then compute the evaluation measures as for the <strong>CT</strong>. To get probabilities in the confusion matrix, we again scale the confusion matrix by the sum of the array.</p>
<section id="id2">
<h5>2.1.3.1 Confusion matrix<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#confusion matrix</span>

<span class="n">cm_MD</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_tests_MD</span><span class="p">,</span> <span class="n">y_preds_MD</span><span class="p">)</span>

<span class="n">cm_MD_f</span> <span class="o">=</span> <span class="n">cm_MD</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cm_MD</span><span class="p">)</span>
  
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Confusion Matrix : </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cm_MD_f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confusion Matrix : 
 [[0.53733103 0.17482759]
 [0.07247586 0.21536552]]
</pre></div>
</div>
</div>
</div>
<p>To plot the confusion matrix visually more appealing again, the following code can be run.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> 
<span class="n">tick_marks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">class_names</span><span class="p">))</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="n">class_names</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="n">class_names</span><span class="p">)</span> 
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cm_MD_f</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;YlGnBu&quot;</span> <span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion matrix for Mean Diffusivity&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual label&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted label&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 257.44, &#39;Predicted label&#39;)
</pre></div>
</div>
<img alt="../_images/fc0bad0d27fd941e9809bd2aed4d3ee56fa20b85fbfcc564a0e163baa1d4b150.png" src="../_images/fc0bad0d27fd941e9809bd2aed4d3ee56fa20b85fbfcc564a0e163baa1d4b150.png" />
</div>
</div>
<p>The confusion matrix reveals that the probability for <strong>hits</strong> is around 22%, for <strong>true negatives</strong> around 54%. The probability for <strong>misses</strong> is around 7% and for <strong>false positive</strong> cases around 17%.</p>
</section>
<section id="model-accuracy-precision-recall-and-f1-score">
<h5>2.1.3.2  Model accuracy, precision, recall and F1-Score<a class="headerlink" href="#model-accuracy-precision-recall-and-f1-score" title="Permalink to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#compute accuracy, precision, recall</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy:&quot;</span><span class="p">,</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_tests_MD</span><span class="p">,</span> <span class="n">y_preds_MD</span><span class="p">))</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Precision:&quot;</span><span class="p">,</span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_tests_MD</span><span class="p">,</span> <span class="n">y_preds_MD</span><span class="p">))</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Recall:&quot;</span><span class="p">,</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_tests_MD</span><span class="p">,</span> <span class="n">y_preds_MD</span><span class="p">))</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;F1-Score:&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_tests_MD</span><span class="p">,</span> <span class="n">y_preds_MD</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.752696551724138
Precision: 0.5519459860723249
Recall: 0.7482090231688909
F1-Score: 0.6352642018003356
</pre></div>
</div>
</div>
</div>
<p>As the values reveal, our logistic regression model for <strong>mean diffusivity</strong> makes 75.26% of the time correct predictions. 55.20% represent the proportion of the model’s prediction of psychosis where psychosis is actually present and 74.82% relate to the proportion of all cases of psychosis that the model accurately predicted.</p>
</section>
</section>
</section>
<section id="fractional-anisotropy">
<h3>2.2 Fractional anisotropy<a class="headerlink" href="#fractional-anisotropy" title="Permalink to this heading">#</a></h3>
<p>Now, the same procedure is applied for <strong>FA</strong>.</p>
<section id="id3">
<h4>2.2.1 Data preparation<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h4>
<p>First, the data is adjusted accordingly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#read data</span>

<span class="n">FA_Dublin_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pardir</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;PARC_500.aparc_FA_cortexAv_mean_Dublin.csv&#39;</span><span class="p">)</span>
<span class="n">FA_Dublin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">FA_Dublin_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#adjust dataframe</span>

<span class="n">FA_Dublin_adj</span> <span class="o">=</span> <span class="n">FA_Dublin</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Subject ID&#39;</span><span class="p">,</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#label group 1 as 0 and 2 as 1</span>

<span class="n">FA_Dublin_adj</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FA_Dublin_adj</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dataframe as numpy array </span>

<span class="n">FA_Dublin_adj</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.   , 0.322, 0.147, ..., 0.157, 0.147, 0.137],
       [0.   , 0.302, 0.155, ..., 0.152, 0.148, 0.152],
       [0.   , 0.324, 0.18 , ..., 0.171, 0.174, 0.143],
       ...,
       [1.   , 0.323, 0.173, ..., 0.181, 0.143, 0.151],
       [1.   , 0.311, 0.174, ..., 0.162, 0.145, 0.123],
       [1.   , 0.294, 0.164, ..., 0.145, 0.147, 0.127]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h4>2.2.2 Build the model<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h4>
<p>Again, the input and output variables are defined. Here, we take the <strong>FA</strong> values for every brain region as input.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define input</span>

<span class="n">X_FA</span> <span class="o">=</span> <span class="n">FA_Dublin_adj</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">309</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#output</span>

<span class="n">y_FA</span> <span class="o">=</span> <span class="n">FA_Dublin_adj</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_FA</span> <span class="o">=</span> <span class="n">y_FA</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>And finally run the model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_iter_FA</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">y_preds_FA</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">y_tests_FA</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># scale before splitting into test and train samples</span>
<span class="n">X_sc_FA</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_FA</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iter</span><span class="p">):</span>
    <span class="c1"># take a new testing and training sample</span>
    <span class="n">X_train_FA</span><span class="p">,</span> <span class="n">X_test_FA</span><span class="p">,</span> <span class="n">y_train_FA</span><span class="p">,</span> <span class="n">y_test_FA</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_sc_FA</span><span class="p">,</span> <span class="n">y_FA</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">y_tests_FA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_test_FA</span><span class="p">)</span>  <span class="c1"># store the y_test sample</span>
    
    <span class="c1"># fit the logistic regression</span>
    <span class="n">classifier_FA</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">solver</span> <span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">)</span>
    <span class="n">classifier_FA</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_FA</span><span class="p">,</span> <span class="n">y_train_FA</span><span class="p">)</span>
    
    <span class="c1"># get the y predictions and store</span>
    <span class="n">y_pred_FA</span> <span class="o">=</span> <span class="n">classifier_FA</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_FA</span><span class="p">)</span>
    <span class="n">y_preds_FA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_pred_FA</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Concatenate the values from each iteration to compute our confusion matrix!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_preds_FA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_preds_FA</span><span class="p">])</span>
<span class="n">y_preds_FA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 0, 0, ..., 1, 0, 1])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_tests_FA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_tests_FA</span><span class="p">])</span>
<span class="n">y_tests_FA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 0, 0, ..., 0, 0, 1])
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h4>2.2.3 Model evaluation<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h4>
<p>Again, to get the probabilites we scale the confusion matrix with sum of its array.</p>
<section id="id6">
<h5>2.2.3.1 Confusion matrix<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#confusion matrix</span>

<span class="n">cm_FA</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_tests_FA</span><span class="p">,</span> <span class="n">y_preds_FA</span><span class="p">)</span>

<span class="n">cm_FA_f</span> <span class="o">=</span> <span class="n">cm_FA</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cm_FA</span><span class="p">)</span>
  
    
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Confusion Matrix : </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cm_FA_f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confusion Matrix : 
 [[0.44015862 0.272     ]
 [0.05826897 0.22957241]]
</pre></div>
</div>
</div>
</div>
<p>To have a nicer plot, again we run the following code!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> 
<span class="n">tick_marks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">class_names</span><span class="p">))</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="n">class_names</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="n">class_names</span><span class="p">)</span> 
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cm_FA_f</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;YlGnBu&quot;</span> <span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion matrix for Fractional Anisotropy&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual label&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted label&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 257.44, &#39;Predicted label&#39;)
</pre></div>
</div>
<img alt="../_images/25e132d4b87a50910b7badcb22be93f1f4da6bfc8f518c72bb466d753a5aced4.png" src="../_images/25e132d4b87a50910b7badcb22be93f1f4da6bfc8f518c72bb466d753a5aced4.png" />
</div>
</div>
<p>The confusion matrix shows that the probability for <strong>hits</strong> is around 23%, for <strong>true negatives</strong> around 44%. The probability for <strong>misses</strong> is around 6%. The probability for <strong>false positive</strong> cases is around 27%.</p>
</section>
<section id="id7">
<h5>2.2.3.2 Model accuracy, precision, recall and F1-Score<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#compute accuracy, precision, recall</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy:&quot;</span><span class="p">,</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_tests_FA</span><span class="p">,</span> <span class="n">y_preds_FA</span><span class="p">))</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Precision:&quot;</span><span class="p">,</span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_tests_FA</span><span class="p">,</span> <span class="n">y_preds_FA</span><span class="p">))</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Recall:&quot;</span><span class="p">,</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_tests_FA</span><span class="p">,</span> <span class="n">y_preds_FA</span><span class="p">))</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;F1-Score:&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_tests_FA</span><span class="p">,</span> <span class="n">y_preds_FA</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.6697310344827586
Precision: 0.45770542294577055
Recall: 0.7975657090830678
F1-Score: 0.5816275717468222
</pre></div>
</div>
</div>
</div>
<p>As the values reveal, our logistic regression model for <strong>fractional anisotropy</strong> makes 66.97% of the time correct predictions. 45.77% represent the proportion of the model’s prediction of psychosis where psychosis is actually present and 79.75% relate to the proportion of all cases of psychosis that the model accurately predicted.</p>
</section>
</section>
</section>
</section>
<section id="summary">
<h2>3. Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p>To summarize the performance measures of our logistic regression models for <strong>CT</strong> and <strong>FA and MD</strong>, we can simply create a table with the relevant data.</p>
<p>For that, we need to import the tabulate function from the tabulate module. However, before this u have to run the  <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">tabulate</span></code>command. Remove the hashtag in the next line, to install it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!pip install tabulate</span>

<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we define our data and the column names and print the table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create data</span>
<span class="n">data_LR</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_tests</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">),</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_tests_MD</span><span class="p">,</span> <span class="n">y_preds_MD</span><span class="p">),</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_tests_FA</span><span class="p">,</span> <span class="n">y_preds_FA</span><span class="p">)],</span> 
        <span class="p">[</span><span class="s2">&quot;Precision&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_tests</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">),</span> <span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_tests_MD</span><span class="p">,</span> <span class="n">y_preds_MD</span><span class="p">),</span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_tests_FA</span><span class="p">,</span> <span class="n">y_preds_FA</span><span class="p">)],</span> 
        <span class="p">[</span><span class="s2">&quot;Recall&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_tests</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">),</span> <span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_tests_MD</span><span class="p">,</span> <span class="n">y_preds_MD</span><span class="p">),</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_tests_FA</span><span class="p">,</span> <span class="n">y_preds_FA</span><span class="p">)],</span> 
        <span class="p">[</span><span class="s2">&quot;F1-Score&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_tests</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">),</span> <span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_tests_MD</span><span class="p">,</span> <span class="n">y_preds_MD</span><span class="p">),</span> <span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_tests_FA</span><span class="p">,</span> <span class="n">y_preds_FA</span><span class="p">)]]</span>
  
<span class="c1">#define header names</span>
<span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Measure&quot;</span><span class="p">,</span> <span class="s2">&quot;Cortical Thickness&quot;</span><span class="p">,</span> <span class="s2">&quot;Mean Diffusivity&quot;</span><span class="p">,</span> <span class="s2">&quot;Fractional Anisotropy&quot;</span><span class="p">]</span>
  
<span class="c1">#display table</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">data_LR</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">col_names</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Measure      Cortical Thickness    Mean Diffusivity    Fractional Anisotropy
---------  --------------------  ------------------  -----------------------
Accuracy               0.681785            0.752697                 0.669731
Precision              0.446441            0.551946                 0.457705
Recall                 0.968729            0.748209                 0.797566
F1-Score               0.611206            0.635264                 0.581628
</pre></div>
</div>
</div>
</div>
<p>What can be seen is, that <strong>CT</strong> has the highest <strong>accuracy</strong> score, <strong>MD</strong> has the highest <strong>precision</strong> score, <strong>CT</strong> the highest <strong>recall</strong> and <strong>MD</strong> the highest <strong>F1-Score</strong>. <strong>Precision and Recall</strong> values are inversely related. As one increases, the other decreases. So when we relate to the <strong>F1-Score</strong>, <strong>MD</strong> is performs better.</p>
<p>In the next pages, a different algorithm is applied to the same data.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./code"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../general_information/Tasktype.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data analysis</p>
      </div>
    </a>
    <a class="right-next"
       href="SVM.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Support Vector Machine (SVM)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#macro-structural-data-cortical-thickness-ct">1. Macro-structural data: Cortical Thickness (CT)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preperation">1.1 Data preperation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-the-model">1.2 Building the model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-evaluation">1.3 Model evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#confusion-matrix">1.3.1 Confusion Matrix</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#model-accuracy-precision-recall-f1-score">1.3.2 Model accuracy, precision, recall F1-Score</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#micro-structural-data-mean-diffusivity-md-and-fractional-anisotropy-fa">2. Micro-structural data: mean diffusivity (MD) and fractional anisotropy (FA)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-diffusivity">2.1 Mean diffusivity</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">2.1.1 Data preparation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#build-the-model">2.1.2 Build the model</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.1.3 Model evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2.1.3.1 Confusion matrix</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#model-accuracy-precision-recall-and-f1-score">2.1.3.2  Model accuracy, precision, recall and F1-Score</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fractional-anisotropy">2.2 Fractional anisotropy</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.2.1 Data preparation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">2.2.2 Build the model</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">2.2.3 Model evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">2.2.3.1 Confusion matrix</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">2.2.3.2 Model accuracy, precision, recall and F1-Score</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">3. Summary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mevlüt Yaglu based on the course template by Felix Koerber and Michael Ernst
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>